---
layout: post
title:  "Work In Progress - Error WIF10201"
date:   2015-6-3 16:17:40
author: Zacharias
---

h3. A difficult-to-search-for WIF error

I ran across this error using a STS in a ASP.Identity scenario:

pre. WIF10201: No valid key mapping found for securityToken: System.IdentityModel.Tokens.X509SecurityToken and issurer

p. There's a good chance that the issuer is using a novel certificate, according to your identity configuration.

p. This can happen for a few reasons, but in the majority of cases, it is when a change happens in your token-signing "certificate chain":http://en.wikipedia.org/wiki/Public_key_certificate.

You can identify the expected certificate "thumbprint" (hash value) in the context of ASP.NET/MVC applications, this can be found in a @web.config@ section in the following XML path: system.identityModel identityConfiguration issuerNameRegistry authority keys. This hexadecimal hash is typically from the wizard configuration.

h4. The source of the error what you'd expect when crypto hashes disagree.

p. Since the token isn't matching up to your configuration's value, there isn't any token handling services to deal with tokens that are signed not in the way you'd expect.

h4. Certificate Chaining

__coming soon: How to confirm your STS hash is correct in ADFS 3.0__